# WEEK01-01切片

```python
import torch
import numpy as np
```

```python
torch.__version__
```

    '1.7.0+cu101'

```python
t=torch.tensor([1,2])
t
```
    tensor([1, 2])
## 元素转变

由于数据复杂性, 且GPU精度运算比较好, 所以一般会转变为tloat来进行运算

```python
t.double()
```
    tensor([1., 2.], dtype=torch.float64)

|数据类型|dtype,前面的函数不能直接使用|
|:--:|:--:|
|32bit浮点数|torch.float32或torch.float|      
|64bit浮点数|torch.float64或torch.double|	      
|16bit浮点数|torch.float16或torch.half|	      
|8bit无符号整数|torch.unit8|    
|8bit有符号整数|torch.int8|
|16bit有符号整数|torch.int16或torch.short|
|32bit有符号整数|torch.int32或torch.int|
|64bit有符号整数|torch.int64或torch.long|
|布尔型|torch.bool|
|复数型|torch.complex64|

## 查看张量的维度

```python
t1=torch.tensor([1,2]).float()
t2=torch.tensor(np.array(([1,2],[3,4])), dtype=torch.float32)
t2=torch.tensor([[1,2],[4,5]], dtype=torch.float32)
```

```python
print(t1)
print(t2)
```
```
    tensor([1., 2.])
    tensor([[1., 2.],
            [3., 4.]])
```    

```python
# s使用ndim
print(t1.ndim)
print(t2.ndim)
```
    1
    2
```python
# 使用shape
print(t1.shape)
print(t2.shape)
```
    torch.Size([2])
    torch.Size([2, 2])

### 产看长度

```python
# 长度 VS 个数
print('T1：'+str(len(t1)) + ' T2：'+str(len(t2)))
print('T1：'+str(t1.numel()) + ' T2：'+str(t2.numel()))
```
    T1：2 T2：2
    T1：2 T2：4
```python
torch.tensor([[1,2],[4,5]])
```
```
    tensor([[1, 2],
            [4, 5]])
```
## 0维张量:标量

```python
t1=torch.tensor(1)
t2=torch.tensor([1])
if t1 == t2:
  print('true')
else: print('F')
```
    true
### 高维张量

```python
t = torch.tensor([[[1,2,3],
          		   [2,4,5],],
          
          		   [[1,6,8],
         		    [0,9,8]]])
t
```
```
    tensor([[[1, 2, 3],
             [2, 4, 5]],
    
            [[1, 6, 8],
             [0, 9, 8]]])
```

```python
t.ndim
```
    3
```python
len(t)
```
    2

```python
# shape排序由大到小
t.shape
```
    torch.Size([2, 2, 3])

```python
t.numel()
```
    12

## 张量的形变

### flantten 把所有张量变为1维,包括0维度

```python
t.flatten()
```
    tensor([1, 2, 3, 2, 4, 5, 1, 6, 8, 0, 9, 8])

### reshape

```python
t.reshape([3,4])
```
```
    tensor([[1, 2, 3, 2],
            [4, 5, 1, 6],
            [8, 0, 9, 8]])
```

```python
t.reshape([3,4]).size()
```
    torch.Size([3, 4])

```python
t.reshape(3,4).size()
```
    torch.Size([3, 4])

## 特殊矩阵

```python
torch.full([2,4],11)
```
```
    tensor([[11, 11, 11, 11],
            [11, 11, 11, 11]])
```
```python
torch.zeros([5,5])
```
```
    tensor([[0., 0., 0., 0., 0.],
            [0., 0., 0., 0., 0.],
            [0., 0., 0., 0., 0.],
            [0., 0., 0., 0., 0.],
            [0., 0., 0., 0., 0.]])
```
```python
torch.ones([5,1])
```
```
    tensor([[1.],
            [1.],
            [1.],
            [1.],
            [1.]])
```
```python
torch.eye(5)
```
```
    tensor([[1., 0., 0., 0., 0.],
            [0., 1., 0., 0., 0.],
            [0., 0., 1., 0., 0.],
            [0., 0., 0., 1., 0.],
            [0., 0., 0., 0., 1.]])
```

### 对角矩阵

`**不能用list创建**`

```python
torch.diag(torch.tensor([1,2,3,4]))
```
```
    tensor([[1, 0, 0, 0],
            [0, 2, 0, 0],
            [0, 0, 3, 0],
            [0, 0, 0, 4]])
```
```python
torch.diag([1,2,3,4,5])
```
```
---------------------------------------------------------------------------

TypeError                                 Traceback (most recent call last)

<ipython-input-26-78906e6eca56> in <module>()
----> 1 torch.diag([1,2,3,4,5])

TypeError: diag(): argument 'input' (position 1) must be Tensor, not list
```

## 随机矩阵

```python
# 0-1分布
torch.rand(2,3)
```
```
    tensor([[0.0363, 0.8784, 0.1162],
            [0.2371, 0.3299, 0.0139]])
```

```python
# 正态分布
torch.randn(2,4)
```
```
    tensor([[-0.8905,  1.3437, -0.6775, -0.4818],
            [-1.5736,  0.7513,  1.1206, -0.9216]])
```

```python
# 正态分布
torch.normal(2,3, size=(3,3)) #均值2, 标准差3
```
```
    tensor([[-1.1571,  1.3496,  4.6315],
            [ 6.9259,  3.6108,  0.2762],
            [ 2.5660, -1.5689,  5.4636]])
```

## like系列

```python
torch.full_like(t, 2)
```
```
    tensor([[[2, 2, 2],
             [2, 2, 2]],
    
            [[2, 2, 2],
             [2, 2, 2]]])
```

```python
torch.randint_like(t, 1,10)
```
```
    tensor([[[1, 3, 4],
             [5, 7, 4]],
    
            [[1, 5, 3],
             [1, 9, 3]]])
```

## 转换

```python
t.tolist()
```

    [[[1, 2, 3], [2, 4, 5]], [[1, 6, 8], [0, 9, 8]]]

```python
list(t)
```
```
    [tensor([[1, 2, 3],
             [2, 4, 5]]), 
	 tensor([[1, 6, 8],
             [0, 9, 8]])]
```

```python
# 只有0维张量才能item()
t.item()
```
```
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)

<ipython-input-38-dc80242434c0> in <module>()
----> 1 t.item()
    

ValueError: only one element tensors can be converted to Python scalars
```

## 拷贝只能用clone, 不能是有.copy()

```python
t.clone()
```
```
    tensor([[[1, 2, 3],
             [2, 4, 5]],
    
            [[1, 6, 8],
             [0, 9, 8]]])
```
