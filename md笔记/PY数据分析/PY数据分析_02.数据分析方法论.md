# 数据分析方法论_数组array

[toc]

---

- 作用:简化计算
- 使用:Numpy
- 导入:`import numpy as np`
- 特征
  - 如果数组中包含`数字`与`字符串`,不能直接计算
  - `array`具有广播功能,`list`不具有广播功能
    ```python
    data = np.array([1,2,3,4,5])
    data[1,3] = 0
    '''
    data = array([1, 0, 0, 4, 5])
    '''
    lis[1,3] = 0
    #会报错
    ```
  - `array`的切片赋值为**传址**操作,`list`的切片赋值为**传值**操作
  - 多维数组的切片为先`行`后`列`

## 1.创建函数

- 通过一维数组

    ```python
    data = np.array([1,2,3,4,5])
    ```

- 定义数组中的元素的类型`dtype`
  
    ```python
    data = np.array([1,2,3,4,5], dtype=object)
    ```

- 创建`0`值数组
    ```python
    # 创建1维0值数组,数据为5
    np.zeros(5)
    # 创建2维0值数组
    np.zeros((5,5))
    ```
- 创建空数组
  - 不在内存中写入数据,所以数组中量为垃圾值
    ```python
    # 创建1维空值数组,数据为5
    np.empty(5)
    # 创建2维空值数组
    np.empty((5,5))
    ```
- 创建1数组矩阵
    ```python
    # 创建1维1数组,数据为5
    np.ones(5)
    # 创建2维1数组
    np.ones((5,5))
    ```
- 创建单位矩阵
    ```python
    # 只有二维数组,正矩阵
    np.identity(5)
    ```

### *模仿其他矩阵创建矩阵*

```python
np.ones_like(data)
np.empty_like(data)
np.zeros_like(data)
```

### *通过arange创建等差数组*

```python
np.arange(起始值, 结束值, 步长)
# 默认`起始值`:0,`步长`:1
np.arange(2,10,2)
# 输出为:[2,4,6,8]
```

### 创建等差数组

```py
x = np.linspace(2, 10, 3)
# (`起始值`, `结束值`, `数组个数`
# 输出[2, 6, 10]
```

## 2.**查看与属性**

### 属性

- `dtype`数组中的元素的类型
    ```python
    dtype(data)
    ```
- `.shape`查询数组的形状,返回一个元组(无括号)
    ```python
    data.shape
    ```

### 参看,索引,切片

- 多维数组的切片为先`行`后`列`
  - `行`与`列`使用`列表`进行多个索引
    ```python
    data = np.arange(16).reshape(4,4)
    '''
    [ 0,  1,  2,  3]
    [ 4,  5,  6,  7]
    [ 8,  9, 10, 11]
    [12, 13, 14, 15]
    '''
    data[1:3,::-1]
    '''
    [ 7,  6,  5,  4]
    [11, 10,  9,  8]
    '''
    ```
- 复杂索引
  - `data[[1,2],[1,2]]`只有2个数值,而不是2*2的矩阵
  - `data[[1,2]][:,[1,2]]`这样才是选择2*2的矩阵
  - `np.ix_([], [])`进行交叉索引
    ```python
    data[np.ix_([1,3], [1,3])]
    # 与以下相同
    data[[1,3]][:, [1,3]]
    ```

## 3.更改属性

- `.reshape()`:更改数组`shape`
  - `.reshape(行数,列数)`
  - 前后的数量必须相等
    ```python
    np.arange(16).reshape(4,4)
    ```
- `astype`:修改数据类型
  - `astype`也可以让字符串类型直接转为数字类型
    ```python
    data = data.astype(np.float64)
    ```

## 4.使用技巧

### 网格化:np.meshgrid(x, y)

- `X, Y = np.meshgrid(x, y)`
    ```python
    x = (1,2,3)
    y = (1,2,3)
    X, Y = np.meshgrid(x, y)
    '''
    X:       Y:
    1,2,3    1,1,1
    1,2,3    2,2,2
    1,2,3    3,3,3
    '''
    ```

### 一维化:np.ravel(X)

- 将2维数组中所有元素放在一个一维数组里
    ```python
    '''
    X:
    1,2,3
    1,2,3
    1,2,3
    '''
    x = np.ravel(X)
    '''
    x = array([1, 2, 3, 1, 2, 3, 1, 2, 3])
    '''
    ```

## 5.随机数

### np.random.seed()

- 使接下来创建的随机数相同
- 可以在不同的时间地点使用相同的随机数

```python
np.random.seed(数字)
```

### np.random.randint

```python
np.random.randint(起始值,末尾值,size=(2,3,4))
```

### 正态分布 np.random.normal

```python
np.random.normal(loc=0.0, scale=1.0 size=(2,2))
```

参数的意义为：

```py
loc：float
    此概率分布的均值（对应着整个分布的中心centre）
scale：float
    此概率分布的标准差（对应于分布的宽度，scale越大越矮胖，scale越小，越瘦高）
size：int or tuple of ints
    输出的shape，默认为None，只输出一个值
```

### 列表打乱

```py
np.random.shuffle(ar1)
```

## 6.数组的运算

### 数组乘积`np.dot(A,B)`

- 结果:`矩阵`
- 要求:`A`的`列数` = `B`的`行数`
> AB相乘的结果C中每一个元素`c`=(`A`中`i行`与`B`中`j列`)这两个向量的`内积`(点积)

### 对角线元素相加`np.trace()`

- 定义:矩阵对角线上的元素相加
- 要求:方阵
- 结果:数字

### 内积

- 要求:形状相同
- 结果:数字
- 公式:$<A,B> = trace(A^HB) = trace(A^TB)$
- 函数:`np.trace(np.dot(ar_1.T, ar_2))`
- 如果需要判断:

```python
def inner_product(ar_1, ar_2):
    if ar_1.shape != ar_2.shape:
        return '矩形shape不一致,请重新选择矩阵'
    return np.trace(np.dot(ar_1.T, ar_2))
```

### 高维数组转置`.transpose`

#### 转至前

对于一个三维数组来说，他的`.shape`函数的返回值为

```python
(x, y, z)
```

此三维数组的轴编号对因为:

```py
(0, 1, 2)

'''
x -→ 0
y -→ 1
z -→ 2
'''
```

> 转至之前,三维数组的轴编号永远为(0, 1, 2)

#### 转至函数

```py
ar2 = ar1.transpose((1, 0, 2))
```

将`ar1`的轴标签转化为(1, 0, 2)

#### 转至后

`.shape`函数的返回值为`(y, x, z)`

#### 全转至(.T)与轴交换(.swapaxes())

全转至指轴标签的倒置,及`(0, 1, 2)`-→`(2, 1, 0)`(.transpoe(2, 1, 0))

轴交换指将两个轴进行交换,比如下面两个等价

```py
ar1.swapaxes(1,2)
ar1.swapaxes(0, 2, 1, 3)
```

---

### 常用的`一元`函数

> 矢量运算,批量运算: 对矩阵中所有元素统一做运算

#### 开方`np.sqrt(ar)`

对所有元素进行开方

#### e的指数函数`np.exp(ar)`

计算出e的所有元素的幂运算值: $e^x$

```py
np.exp([[0, 1],
        [1, 0]])
out:
[1, e]
[e, 1]
```

#### 绝对值`np.abs(ar)`

返回所有元素的绝对值

#### `np.sinh(ar)`和`np.conh(ar)`

对矩阵中所有的值做以下操作

$$
sinh(x) = \frac{e^x - e^{-x}} {2}
$$

$$
sinh(x) = \frac{e^x + e^{-x}} {2}
$$

#### 向下取整,向上取整函数

- 向下取整`np.floor(ar)`
- 向上取整`np.ceil(ar)`

#### 符号函数(取`±`号)`np.sign(ar)`

### 常用的`二元`函数

#### 比较2个矩阵同样位置的最大值`np.maximum(a1,a2)`

```py
a1 = np.array([1,1,1],
              [2,2,2])
a1 = np.array([2,2,2],
              [1,1,1])
np.maximum(a1,a2)

out:
[2,2,2]
[2,2,2]
```

#### `加减乘除`函数

- 减:`np.subtract(ar_13,ar_14)`
- 加:`np.add(ar_13,ar_14)`
- 除:`np.divide(ar_13,ar_14)`
- 乘:`np.multiply(ar_13,ar_14)`

#### 幂函数`np.power(a1,a2)`

`a1`的元素是`底`,`a2`的元素是`幂`

$$
a1^{a2}
$$

## 7.挑选与基本统计函数

### **快速找到所需数据`np.where()`**

```python
np.where(condition,x,y)
# np.where(判断条件,[,真值返回,假值返回结果])
# 如果只有判断条件,则返回`true`值对应索引
```

#### 条件为单布尔值

```py
a = 32
np.where([type(a) == int], '整数', '小数')

out:
'整数'
```

```py
a = np.ones((5,5))
np.where([type(a) == int], '整数', '小数')
```
