# 安装后

**tag:**  #linux #linux/install #linux/firewall

- cat /etc/group
- dnf provides vim
- nmtui
- netstat -aptn
- df -h
- echo $SHELL

## 设置字体
- 下载[nerd字体](https://www.nerdfonts.com/font-downloads)
	- `Inconsolata`,`DejaVuSansMono`, `AnonymousPro`
- 解压到`/usr/local/share/fonts`
- `fc-list`进行查看

## selinux

修改`/etc/selinux/config` 文件
将`SELINUX=enforcing`改为`SELINUX=disabled`

## 防火墙

```shell
firewall-cmd --zone=public --add-port=80/tcp --permanent
```

## 用户

```shell
groupadd webcontrol
groupdel webcontrol

useradd -m qweerer
passwd qweerer
userdel -r qweerer

#为用户组webcontrol添加用户
gpasswd -a root webcontrol 
gpasswd -a qweerer webcontrol
#为用户组webcontrol删除用户
gpasswd -d qweerer webcontrol
```

## 添加sudo用户

```shell
vi /etc/sudoer
qweerer ALL=(ALL) ALL
```

## 调整时区

## 改变语言

```shell
vi /etc/locale.conf

LANG=zh_CN.UTF8
LANG=en_US.UTF8

localectl set-locale LANG=en_US.UTF-8
dnf install langpacks-en glibc-all-langpacks -y
# dnf install glibc-langpack-en
```

## ssh-log

```shell
vim  /etc/ssh/sshd_config 
# 将SyslogFacility AUTHPRIV改为SyslogFacility local5
RSAAuthentication yes
PubkeyAuthentication yes
PermitRootLogin prohibit-password

vim /etc/rsyslog.d/50-default.conf
## 加入下面两行
＃ save sshd messages also to sshd.log
local5.*  /data/log/sshd.log
```

## 安装软件

- gcc (编译C语言)
- net-tools
- tar
- bzip

## 虚拟机设置

### centos

```shell
dnf install kernel-headers kernel-devel make
yum install elfutils-libelf-devel
yum update kernel kernel-headers kernel-devel


# centos7修改默认内核
cat /boot/grub2/grub.cfg |grep "menuentry "  # 查看所有可用内核
grub2-set-default 'CentOS Linux (3.10.0-327.el7.x86_64) 7 (Core)' #设置默认启动的内核
grub2-editenv list  # 查看内核修改结果
saved_entry=CentOS Linux (3.10.0-327.el7.x86_64) 7 (Core)

# centos8修改默认内核
grubby --default-kernel
grubby --info=ALL  # 查看所以安装的内核信息~
#设置启动内核~(这个不用设置，我这只是为了演示。默认都设置了最新的~~~)
grubby --set-default /boot/vmlinuz-5.5.1-1.el8.elrepo.x86_64

# 注意修改默认内核后要reboot后才能生效。

#启动之后
uname -r #查看当前启动的内核版本
rpm -qa | grep kernel-[0-9] #查看全部的内核
yum remove 旧版本内核 #删除旧版本内核

mount /dev/sr0 /media/virtual
cd /media/virtual/
```

### arch

```shell
pacman -Syyu
# 安装man（help)
pacman -S man
pacman -S base-devel
# 虚拟机
pacman -S xf86-video-vesa
pacman -S xf86-video-vmware
pacman -S virtualbox-guest-utils
pacman -S virtualbox-guest-dkms
sudo pacman -S linux-headers=`uname -r`
```

### debian

```shell
dpkg -l|grep linux-image
apt-get remove linux-image-5.10.0-10-amd64
update-grub
reboot

```

## 全局变量

vi /etc/profile.d/user_loc_bin.sh在新的java.sh中输入以下内容：

```shell
export
#set local environment 
user_loc_bin=/usr/local/bin
export user_loc_bin
```
保存退出，然后给`user_loc_bin.sh`分配权限：

```shell
chmod 755
/etc/profile.d/java.sh
echo $JAVA\_HOME
```

### 全局alias

```shell
vi /etc/profile

alias docker='podman'

source /etc/profile
```

## 回收站

```shell
mkdir /recycle
vi /etc/bashrc

alias del mv -r 
```

## 设置开机启动

[开机启动](./01-docker/01.docker.md#开机启动)

## podman

![01.podman容器](./01-docker/01.podman容器.md)

修改默认目录

```shell
vim /etc/containers/storage.conf

# Primary Read/Write location of container storage
graphroot = "/var/lib/containers/storage"
```
### 如果打开SElinux操作

Add SELinux rules if it is in enforcing mode.

And only if you are using SELinux in enforcing mode you must transfer the rules for the new location. Just list the SELinux rules, pick only those with the old path, and add the same rules with the new path.  
First, check the status of the SELinux with:

```shell
~ getenforce
Enforcing
```

Add the rules for the new path:

```shell
semanage fcontext -l|grep /var/lib/containers
semanage fcontext -a -e /var/lib/containers /home/podman
restorecon -Rv /home/podman
```

## swap

```bash
dd if=/dev/zero of=./swapfile.swap bs=1M count=4096
mkswap ./swapfile.swap
chown root:root swapfile.swap
chmod 0600 swapfile.swap
swapon /mnt/nvme0-kioxia-1t/swapfile.swap

vim /etc/fstab
#==========================
/mnt/nvme01-1t/swapfile.swap none swap sw 0 0
#==========================

vim /etc/rc.local
#==========================
#!/bin/sh -e

exit 0
#==========================
systemctl enable rc-local
systemctl start rc-local
# 验证
free -m
swapon -s
```